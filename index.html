<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Apology Website (fixed)</title>
<style>
/* === Base / reset === */
* { box-sizing: border-box; margin:0; padding:0; }
body { font-family: Arial, sans-serif; background: #ffe6ec; overflow:hidden; }

/* === LOGIN === */
#login-form {
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  height:100vh;
  background: url('photo3.jpeg') center/cover no-repeat;
}
#login-form h1 { color:white; text-shadow:0 0 10px black; margin-bottom:18px; font-size:32px; }
#login-form input { padding:10px; border-radius:6px; border:none; margin:6px 0; width:220px; font-size:16px; }
#login-btn { background:#ff4d6d; color:#fff; cursor:pointer; }

/* === MAIN PAGE LAYOUT === */
#main { display:none; height:100vh; position:relative; padding:20px; }

/* logout */
#logout {
  position:absolute; left:20px; bottom:20px;
  background:#ff4d6d; color:white; border:none; padding:8px 14px; border-radius:8px; cursor:pointer; z-index:60;
}

/* photos on right */
#photos {
  position:absolute; right:40px; top:50%; transform:translateY(-50%); display:flex; flex-direction:column; gap:18px; z-index:10;
}
#photos img { width:350px; border-radius:15px; box-shadow:0 4px 12px rgba(0,0,0,.2); max-width:90vw; }

/* tabs left column */
.tabs {
  position:absolute; left:40px; top:50%; transform:translateY(-50%); z-index:20;
  display:flex; flex-direction:column;
}
.tab-btn {
  width:180px; padding:12px 16px; margin-bottom:10px; border-radius:8px; background:#ff4d6d; color:#fff; border:none; cursor:pointer; font-size:17px;
}

/* below area (where message / puzzle / quiz live) */
#below-area {
  position:absolute; left:40px; top:65%; transform:translateY(0);
  width:360px; z-index:30;
  max-height:56vh; /* prevents overflow off screen */
  overflow:auto; /* scroll if content too large */
  padding-bottom:16px;
}

/* message box */
#message-content {
  display:none;
  background:white; padding:18px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,.12);
  white-space:pre-line; line-height:1.6;
}

/* puzzle box (kept original behaviour) */
#puzzle-box { display:none; margin-top:14px; }
#puzzle-container { position:relative; width:300px; height:300px; margin:12px auto 6px; overflow:hidden; }
.tile { position:absolute; transition: top .25s, left .25s; cursor:pointer; border:1px solid white; }
#puzzle-message { display:none; margin-top:8px; background:#fff0f5; padding:10px; border-radius:10px; font-weight:bold; }
#puzzle-back, #controls button { margin-top:10px; padding:10px 14px; background:#ff4d6d; color:white; border:none; border-radius:8px; cursor:pointer; }

/* quiz box */
#quiz-box { display:none; margin-top:14px; background:white; padding:12px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,.12); }
#quiz-image { width:100%; height:160px; object-fit:cover; border-radius:8px; }
#quiz-question { margin-top:10px; font-weight:bold; }
.answer-option { margin-top:8px; padding:10px; border-radius:8px; background:#f6f6f6; cursor:pointer; border:1px solid transparent; }
.answer-option.selected { background:#ffe6eb; border-color:#ff4d6d; }
.quiz-controls { margin-top:12px; display:flex; gap:8px; flex-wrap:wrap; }
.btn-red { background:#ff4d6d; color:white; border:none; padding:10px 12px; border-radius:8px; cursor:pointer; }

/* hearts (unchanged) */
.heart { position:absolute; width:90px; height:90px; background:red; transform:rotate(-45deg); opacity:.9; z-index:100; }
.heart:before,.heart:after { content:""; position:absolute; width:90px; height:90px; background:red; border-radius:50%; }
.heart:before { top:-45px; left:0 } .heart:after { left:45px; top:0 }
.heart span { position:absolute; top:55%; left:50%; transform:translate(-50%,-50%) rotate(45deg); color:white; font-weight:bold; text-shadow:0 0 6px black; pointer-events:none; text-align:center; width:80px; }

/* small screens */
@media (max-width:800px){
  #photos img { width:220px; }
  .tab-btn { width:150px; font-size:15px; }
  #below-area { left:20px; width:300px; top:62%; max-height:52vh; }
  .heart { width:70px; height:70px; } .heart:before,.heart:after { width:70px;height:70px } .heart span { font-size:12px; width:60px; }
}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="login-form">
  <h1>Login</h1>
  <input id="name" type="text" placeholder="Enter your name" />
  <input id="login-btn" type="submit" value="Login" />
</div>

<!-- MAIN -->
<div id="main">
  <button id="logout">Logout</button>

  <div class="tabs">
    <button class="tab-btn" id="show-message">Apology Message</button>
    <button class="tab-btn" id="show-puzzle">Puzzle</button>
    <button class="tab-btn" id="show-quiz">Quiz</button>
  </div>

  <div id="below-area">
    <!-- Apology message -->
    <div id="message-content"></div>

    <!-- Puzzle -->
    <div id="puzzle-box">
      <div id="puzzle-container"></div>
      <div id="puzzle-message"></div>
      <button id="puzzle-back" onclick="closePuzzle()">Back</button>
      <div id="controls">
        <button onclick="startPuzzle(2)">2×2</button>
        <button onclick="startPuzzle(3)">3×3</button>
        <button onclick="startPuzzle(4)">4×4</button>
      </div>
    </div>

    <!-- Quiz -->
    <div id="quiz-box">
      <img id="quiz-image" src="" alt="quiz bg" />
      <div id="quiz-question"></div>
      <div id="quiz-options"></div>

      <div class="quiz-controls">
        <button class="btn-red" id="prev-btn">Previous</button>
        <button class="btn-red" id="next-btn">Next</button>
        <button class="btn-red" id="submit-btn" style="display:none">Submit</button>
        <button class="btn-red" id="close-quiz">Close</button>
      </div>

      <div id="quiz-results" style="display:none; margin-top:10px; background:#fff7f8; padding:10px; border-radius:8px;"></div>
    </div>
  </div>

  <div id="photos">
    <img src="photo.jpg" alt="photo1" />
    <img src="photo2.jpg" alt="photo2" />
  </div>
</div>

<script>
/* ======================
   LOGIN & LOGOUT
   ====================== */
const loginBtn = document.getElementById('login-btn');
loginBtn.addEventListener('click', () => {
  const name = document.getElementById('name').value.trim();
  if (name === 'Zodwa' || name === 'Admin') {
    document.getElementById('login-form').style.display = 'none';
    document.getElementById('main').style.display = 'block';
    startHearts();
  } else alert('Incorrect name.');
});
document.getElementById('logout').addEventListener('click', () => location.reload());

/* ======================
   APOLOGY MESSAGE (toggle)
   ====================== */
const messageBtn = document.getElementById('show-message');
const messageBox = document.getElementById('message-content');
const APOLOGY = `I’m really sorry for what I’ve done I hurt you and there’s no excuse for it you’ve always shown me love loyalty and patience and I broke the trust again in which we just reestablished and rebuilt and that you gave me I want you to know that my actions are a reflection of my flaws I should’ve handled the situation differently I handled everything terribly you are an incredible strong caring intelligent I should have been as amazing as you have been to me and I’m sorry for failing you I just want you to know that I truly value you and I’m committed to understanding you better you deserve the world I’m sorry for hurting you you mean a lot to me and I hope that I can show you that I only handled the situation wrong not that I don’t love you

I love you ❤️`;

messageBtn.addEventListener('click', () => {
  const pb = document.getElementById('puzzle-box');
  const qb = document.getElementById('quiz-box');
  const isShown = messageBox.style.display === 'block';
  // hide others, then toggle message
  pb.style.display = 'none';
  qb.style.display = 'none';
  messageBox.style.display = isShown ? 'none' : 'block';
  if (!isShown) messageBox.innerText = APOLOGY;
});

/* ======================
   HEARTS (unchanged behavior)
   ====================== */
function startHearts(){
  const main = document.getElementById('main');
  const words = ["Zodwa","I","am","sorry","I love you"];
  words.forEach(word => {
    const h = document.createElement('div');
    h.className = 'heart';
    const s = document.createElement('span');
    s.innerText = word;
    h.appendChild(s);
    main.appendChild(h);
    // random start pos
    h.style.left = Math.random() * (window.innerWidth - 120) + 'px';
    h.style.top  = Math.random() * (window.innerHeight - 120) + 'px';
    // movement
    let dx = (Math.random() - 0.5) * 2.5;
    let dy = (Math.random() - 0.5) * 2.5;
    function move(){
      let x = parseFloat(h.style.left);
      let y = parseFloat(h.style.top);
      x += dx * 2; y += dy * 2;
      if (x < 0 || x > window.innerWidth - 90) dx *= -1;
      if (y < 0 || y > window.innerHeight - 90) dy *= -1;
      h.style.left = x + 'px'; h.style.top = y + 'px';
      requestAnimationFrame(move);
    }
    move();
  });
}

/* ======================
   PUZZLE (original functions kept)
   ====================== */
const messages = ["You are the best girlfriend!","You make me so happy and I love you so much!","I am sorry ❤️"];
const puzzleImages = ["Puzzel1.JPG","Puzzel2.JPG","Puzzel3.jpeg"];
let gridSize, tiles = [], emptyPos = {}, imgSize = 300;

function startPuzzle(size){
  gridSize = size;
  const container = document.getElementById('puzzle-container');
  container.innerHTML = '';
  tiles = [];
  document.getElementById('puzzle-message').style.display = 'none';
  document.getElementById('puzzle-back').style.display = 'inline-block';
  document.getElementById('puzzle-box').style.display = 'block';

  const imgSrc = puzzleImages[size-2];
  const tileSize = imgSize / size;

  for (let r=0; r<size; r++){
    for (let c=0; c<size; c++){
      if (r===size-1 && c===size-1){
        emptyPos = {row:r, col:c};
        continue;
      }
      const tile = document.createElement('div');
      tile.className = 'tile';
      tile.dataset.row = r; tile.dataset.col = c;
      tile.dataset.rowOrig = r; tile.dataset.colOrig = c;
      tile.style.width = tileSize + 'px';
      tile.style.height = tileSize + 'px';
      tile.style.top = (r*tileSize) + 'px';
      tile.style.left = (c*tileSize) + 'px';
      tile.style.backgroundImage = `url(${imgSrc})`;
      tile.style.backgroundSize = `${imgSize}px ${imgSize}px`;
      tile.style.backgroundPosition = `-${c*tileSize}px -${r*tileSize}px`;
      tile.addEventListener('click', () => moveTile(tile));
      container.appendChild(tile);
      tiles.push(tile);
    }
  }
  shuffleTiles();
}

function shuffleTiles(){
  for (let i=0;i<200;i++){
    const neighbors = tiles.filter(t => isNeighbor(t, emptyPos));
    const tile = neighbors[Math.floor(Math.random()*neighbors.length)];
    swapTile(tile);
  }
}

function isNeighbor(tile, pos){
  const r = parseInt(tile.dataset.row), c = parseInt(tile.dataset.col);
  return (r === pos.row && Math.abs(c - pos.col) === 1) || (c === pos.col && Math.abs(r - pos.row) === 1);
}

function moveTile(tile){
  if (isNeighbor(tile, emptyPos)){
    swapTile(tile);
    checkSolved();
  }
}

function swapTile(tile){
  const tileSize = imgSize / gridSize;
  const oldRow = parseInt(tile.dataset.row), oldCol = parseInt(tile.dataset.col);
  tile.dataset.row = emptyPos.row; tile.dataset.col = emptyPos.col;
  tile.style.top = (emptyPos.row * tileSize) + 'px';
  tile.style.left = (emptyPos.col * tileSize) + 'px';
  emptyPos.row = oldRow; emptyPos.col = oldCol;
}

function checkSolved(){
  const solved = tiles.every(t => parseInt(t.dataset.row) === parseInt(t.dataset.rowOrig) && parseInt(t.dataset.col) === parseInt(t.dataset.colOrig));
  if (solved){
    const pm = document.getElementById('puzzle-message');
    pm.innerText = messages[gridSize-2];
    pm.style.display = 'block';
  }
}

function closePuzzle(){
  document.getElementById('puzzle-container').innerHTML = '';
  document.getElementById('puzzle-message').style.display = 'none';
  document.getElementById('puzzle-back').style.display = 'none';
  document.getElementById('puzzle-box').style.display = 'none';
}

/* ======================
   TABS: toggle behavior (click again to close)
   ====================== */
const puzzleTab = document.getElementById('show-puzzle');
const quizTab = document.getElementById('show-quiz');

puzzleTab.addEventListener('click', () => {
  const pb = document.getElementById('puzzle-box');
  const qb = document.getElementById('quiz-box');
  const mb = document.getElementById('message-content');
  // hide others
  qb.style.display = 'none';
  mb.style.display = 'none';
  // toggle puzzle
  pb.style.display = (pb.style.display === 'block') ? 'none' : 'block';
});

quizTab.addEventListener('click', () => {
  const qb = document.getElementById('quiz-box');
  const pb = document.getElementById('puzzle-box');
  const mb = document.getElementById('message-content');
  pb.style.display = 'none';
  mb.style.display = 'none';
  qb.style.display = (qb.style.display === 'block') ? 'none' : 'block';
});

/* ======================
   QUIZ (with preloading)
   ====================== */
const quizData = [
  { q:"Where did we first meet?", options:["Greenmeadows","Ringball","At BLK","On Bult"], answer:1, img:"Quiz1.GIF" },
  { q:"When is our anniversary?", options:["28 March","13 May","5 November","14 May"], answer:1, img:"Quiz2.GIF" },
  { q:"What movie in Potch did we watch together?", options:["Fast and Furious","Avengers","Titanic","The Notebook"], answer:0, img:"Quiz3.jpeg" },
  { q:"What is my favorite nickname for each other?", options:["Mam Z and Bab Z","Baby","My Love","Bully"], answer:0, img:"Quiz4.jpeg" },
  { q:"What’s the funniest memory we shared?", options:["when running","When you first met my mom","When you first met my sister","When you first met my Dad"], answer:1, img:"Quiz5.jpeg" },
  { q:"What have I said to you that made you cry?", options:["I love you","I am proud of you","You’re amazing","I miss you"], answer:[0,1], img:"Quiz6.jpeg" },
  { q:"What do I love most about you?", options:["Your laugh","Everything","Your looks","Your smile"], answer:1, img:"Quiz7.jpeg" },
  { q:"What’s your favorite thing we do together on weekends?", options:["Watch movies","Run and get food after","Play basketball games","Chilling with the family"], answer:1, img:"Quiz8.JPG" },
  { q:"What’s the best moment we’ve ever spent together?", options:["Magical night together","Our first date","Birthday celebration","A walk together"], answer:0, img:"Quiz9.jpeg" },
  { q:"If you could describe us in one word, what would it be?", options:["Perfect","Fun","Crazy","Beautiful"], answer:0, img:"Quiz11.jpeg" }
];

// preload
quizData.forEach(q => { const i = new Image(); i.src = q.img; });

let qi = 0;
let userAnswers = Array(quizData.length).fill(null);

const quizImage = document.getElementById('quiz-image');
const quizQuestion = document.getElementById('quiz-question');
const quizOptions = document.getElementById('quiz-options');
const prevBtn = document.getElementById('prev-btn');
const nextBtn = document.getElementById('next-btn');
const submitBtn = document.getElementById('submit-btn');
const resultsBox = document.getElementById('quiz-results');
const closeQuiz = document.getElementById('close-quiz');

function renderQuiz(i){
  const q = quizData[i];
  quizImage.src = q.img;
  quizQuestion.innerText = (i+1) + '. ' + q.q;
  quizOptions.innerHTML = '';
  q.options.forEach((opt, idx) => {
    const d = document.createElement('div');
    d.className = 'answer-option';
    d.innerText = opt;
    if (userAnswers[i] === idx) d.classList.add('selected');
    d.addEventListener('click', () => {
      userAnswers[i] = idx;
      renderQuiz(i);
    });
    quizOptions.appendChild(d);
  });
  prevBtn.style.display = i === 0 ? 'none' : 'inline-block';
  nextBtn.style.display = i === quizData.length - 1 ? 'none' : 'inline-block';
  submitBtn.style.display = i === quizData.length - 1 ? 'inline-block' : 'none';
  resultsBox.style.display = 'none';
}

prevBtn.addEventListener('click', () => { if (qi>0) { qi--; renderQuiz(qi); }});
nextBtn.addEventListener('click', () => { if (qi<quizData.length-1) { qi++; renderQuiz(qi); }});
submitBtn.addEventListener('click', () => {
  // compile results
  let score = 0; let out = '<strong>Correct answers:</strong><br>';
  quizData.forEach((q, idx) => {
    let correctText;
    if (Array.isArray(q.answer)) correctText = q.answer.map(a => q.options[a]).join(', ');
    else correctText = q.options[q.answer];
    const you = (userAnswers[idx] === null) ? ' — (no answer)' : ' — you: ' + (q.options[userAnswers[idx]] || '');
    // scoring for multi-answer allowed (treat any included as correct)
    if (Array.isArray(q.answer)) {
      if (userAnswers[idx] !== null && q.answer.includes(userAnswers[idx])) score++;
    } else {
      if (userAnswers[idx] === q.answer) score++;
    }
    out += `Q${idx+1}: ${correctText}${you}<br>`;
  });
  out += `<br><strong>Score: ${score} / ${quizData.length}</strong>`;
  resultsBox.innerHTML = out;
  resultsBox.style.display = 'block';
});
closeQuiz.addEventListener('click', () => { document.getElementById('quiz-box').style.display = 'none'; });

renderQuiz(qi); // init first question
</script>
</body>
</html>
