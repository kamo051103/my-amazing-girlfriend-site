<script>
    window.onload = function() {
        // Fetch data.json from GitHub
        fetch('https://raw.githubusercontent.com/kamo051103/my-amazing-girlfriend-site/main/data.json')
            .then(response => response.json())
            .then(data => {
                let cuteMessage = data.cuteMessage || "Hello Baby";
                let backgroundUrl = data.backgroundUrl || "photo.JPG";
                let cuteVideo = data.cuteVideo || "video.MP4";

                // Set background image
                document.body.style.backgroundImage = `url('${backgroundUrl}')`;

                // Setup the login form functionality
                setupLoginForm();

                // Login form logic
                function setupLoginForm() {
                    const form = document.getElementById('login-form');
                    form.addEventListener('submit', function (e) {
                        e.preventDefault();  // Prevent the page from refreshing

                        const name = document.getElementById('name').value.trim();

                        if (name === 'Zodwa') {
                            // Change the page content for Zodwa
                            document.body.innerHTML = `
                                <h1>How Amazing Girlfriend Is</h1>
                                <div id="options">
                                    <button id="paragraph-btn">Cute Paragraph</button>
                                    <button id="video-btn">Cute Video</button>
                                </div>
                                <div id="content"></div>
                                <button id="logout-btn">Log Out</button>
                            `;
                            setupZodwaPage(cuteMessage, cuteVideo);
                        } else if (name === 'Admin') {
                            // Change the page content for Admin
                            document.body.innerHTML = `
                                <h1>Admin Page</h1>
                                <button id="update-paragraph-btn">Update Cute Message</button>
                                <button id="change-background-btn">Change Background</button>
                                <button id="change-video-btn">Change Cute Video</button>
                                <button id="logout-btn">Log Out</button>
                            `;
                            setupAdminPage();
                        } else {
                            alert('Incorrect name. Try again!');
                        }
                    });
                }

                // Zodwa Page Setup
                function setupZodwaPage(cuteMessage, cuteVideo) {
                    const paragraphBtn = document.getElementById('paragraph-btn');
                    const videoBtn = document.getElementById('video-btn');
                    const contentDiv = document.getElementById('content');
                    const logoutBtn = document.getElementById('logout-btn');

                    // Display cute message when "Cute Paragraph" is clicked
                    paragraphBtn.addEventListener('click', () => {
                        contentDiv.innerHTML = `<p>${cuteMessage}</p>`;
                    });

                    // Display cute video when "Cute Video" is clicked
                    videoBtn.addEventListener('click', () => {
                        contentDiv.innerHTML = `
                            <video width="100%" height="600" controls>
                                <source src="${cuteVideo}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        `;
                    });

                    // Handle logout
                    logoutBtn.addEventListener('click', () => {
                        document.body.innerHTML = `
                            <h1>Login</h1>
                            <div id="login-form">
                                <label for="name">Enter your name:</label>
                                <input type="text" id="name" name="name" required>
                                <input type="submit" value="Login">
                            </div>
                        `;
                        setupLoginForm(); // Reinitialize the login form after logout
                    });
                }

                // Admin Page Setup
                function setupAdminPage() {
                    const updateParagraphBtn = document.getElementById('update-paragraph-btn');
                    const changeBackgroundBtn = document.getElementById('change-background-btn');
                    const changeVideoBtn = document.getElementById('change-video-btn');
                    const logoutBtn = document.getElementById('logout-btn');

                    // Update the cute message
                    updateParagraphBtn.addEventListener('click', () => {
                        const newCuteMessage = prompt("Enter new cute message:");
                        cuteMessage = newCuteMessage;
                        localStorage.setItem('cuteMessage', cuteMessage);  // Save to localStorage

                        // Immediately update for Zodwa (if logged in)
                        const contentDiv = document.getElementById('content');
                        if (contentDiv) {
                            contentDiv.innerHTML = `<p>${cuteMessage}</p>`;
                        }
                    });

                    // Change background image
                    changeBackgroundBtn.addEventListener('click', () => {
                        const newBackgroundUrl = prompt("Enter new background URL:");
                        backgroundUrl = newBackgroundUrl;
                        document.body.style.backgroundImage = `url('${backgroundUrl}')`;
                    });

                    // Change cute video
                    changeVideoBtn.addEventListener('click', () => {
                        const newCuteVideo = prompt("Enter new cute video URL:");
                        cuteVideo = newCuteVideo;
                        localStorage.setItem('cuteVideo', cuteVideo);  // Save to localStorage

                        // Immediately display the new video
                        const contentDiv = document.getElementById('content');
                        contentDiv.innerHTML = `
                            <video width="100%" height="600" controls>
                                <source src="${cuteVideo}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        `;
                    });

                    // Handle logout
                    logoutBtn.addEventListener('click', () => {
                        document.body.innerHTML = `
                            <h1>Login</h1>
                            <div id="login-form">
                                <label for="name">Enter your name:</label>
                                <input type="text" id="name" name="name" required>
                                <input type="submit" value="Login">
                            </div>
                        `;
                        setupLoginForm(); // Reinitialize the login form after logout
                    });
                }
            })
            .catch(error => {
                console.error('Error fetching settings:', error);
            });
    };
</script>
